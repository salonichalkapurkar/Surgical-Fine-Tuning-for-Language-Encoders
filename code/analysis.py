import numpy as np
import matplotlib.pyplot as plt

def plot_average_with_error_bars(list_of_lists, attr, dataset_name):
    # Stack the list of lists using numpy
    stacked_array = np.stack(list_of_lists, axis=0)
    
    # Compute the mean and standard deviation for each column
    mean_values = np.mean(stacked_array, axis=0)
    std_values = np.std(stacked_array, axis=0)
    
    # Plot the mean values with error bars
    plt.errorbar(np.arange(mean_values.shape[0]), mean_values, yerr=std_values, fmt='-o')
    plt.ylim(0, 1)
    plt.xlabel('Layers')
    plt.ylabel('Average Density')
    plt.title(f"Attribute: {attr}, Dataset: {dataset_name}")
    plt.savefig(f"./results/figs/average_density_{attr}.png", dpi=500, bbox_inches='tight')
    plt.show()
    plt.clf()

# model: bert-base-multilingual-cased
# sst2 
res = [[0.805078125, 0.7537760416666667, 0.6885416666666666, 0.5329427083333332, 0.6708333333333334, 0.6774739583333332, 0.68359375, 0.6277343750000001, 0.6432291666666667, 0.6446614583333333, 0.6501302083333333, 0.7000000000000001],

[0.7901041666666666, 0.7335069444444443, 0.666579861111111, 0.4967881944444444, 0.6471354166666666, 0.6567708333333333, 0.6605902777777778, 0.6008680555555556, 0.6196180555555556, 0.6208333333333333, 0.6236979166666666, 0.6846354166666666],

[0.7883463541666668, 0.7321614583333332, 0.6649088541666667, 0.4931640625, 0.6446614583333333, 0.6551432291666667, 0.6577473958333333, 0.5981770833333333, 0.6182291666666667, 0.6199869791666667, 0.6249348958333333, 0.6848958333333334],

[0.773125, 0.7160416666666668, 0.6477083333333334, 0.46932291666666676, 0.6278645833333333, 0.6386979166666666, 0.6404166666666667, 0.57921875, 0.5983854166666667, 0.5986458333333333, 0.6027604166666666, 0.6669791666666667],

[0.7725260416666666, 0.714626736111111, 0.6480034722222222, 0.46970486111111115, 0.6268229166666667, 0.6378472222222222, 0.6396267361111111, 0.578342013888889, 0.5983506944444444, 0.5971354166666667, 0.6008246527777777, 0.6654513888888889],

[0.7714285714285714, 0.7133928571428573, 0.6476562499999999, 0.46979166666666666, 0.6271949404761905, 0.6386904761904763, 0.6400297619047618, 0.5779761904761904, 0.5976190476190476, 0.5969494047619047, 0.6003348214285714, 0.6652901785714286]]
plot_average_with_error_bars(res, "sentiment", "SST2")

# cola 
res = [[0.78515625, 0.7571614583333334, 0.6805989583333334, 0.5786458333333333, 0.6415364583333333, 0.6708333333333334, 0.6691406249999999, 0.5919270833333333, 0.6045572916666667, 0.5852864583333334, 0.6213541666666667, 0.633203125], 
    [0.7722222222222221, 0.7428819444444444, 0.6635416666666667, 0.5581597222222222, 0.6167534722222222, 0.6495659722222222, 0.646701388888889, 0.5659722222222222, 0.58046875, 0.5610243055555556, 0.6001736111111111, 0.615625], 
    [0.7721354166666669, 0.7428385416666666, 0.6632161458333333, 0.5595052083333333, 0.6166666666666667, 0.6487630208333334, 0.6452473958333333, 0.5663411458333334, 0.5797526041666666, 0.5628255208333334, 0.598828125, 0.6145833333333334], 
    [0.7598958333333332, 0.7260416666666667, 0.6465104166666666, 0.5371354166666666, 0.5977604166666667, 0.6297916666666667, 0.6261458333333333, 0.54546875, 0.5602083333333333, 0.5447395833333333, 0.5789583333333334, 0.5978645833333334], 
    [0.7586371527777778, 0.7256510416666667, 0.6454861111111111, 0.5376736111111111, 0.5967447916666667, 0.6286892361111112, 0.6250434027777777, 0.5440972222222222, 0.5609375, 0.542751736111111, 0.5768663194444444, 0.5958767361111111], 
    [0.7574776785714286, 0.7249627976190475, 0.6456845238095239, 0.5373139880952381, 0.5961681547619048, 0.6294270833333333, 0.6252604166666668, 0.5438244047619047, 0.5601934523809523, 0.5423735119047619, 0.5774181547619047, 0.5952752976190476]
       ]

plot_average_with_error_bars(res, "grammar", "CoLA")

# emotion 
res = [[0.5929687499999999, 0.5592447916666666, 0.4747395833333334, 0.36015625, 0.5614583333333333, 0.5971354166666666, 0.5690104166666666, 0.5614583333333333, 0.5337239583333333, 0.5401041666666667, 0.5790364583333333, 0.578515625],  
[0.5657986111111111, 0.5338541666666666, 0.44296874999999997, 0.32135416666666666, 0.5269965277777778, 0.5713541666666666, 0.53828125, 0.5295138888888888, 0.5046875000000001, 0.5095486111111112, 0.5503472222222222, 0.5510416666666668], 
[0.5654296875, 0.5333333333333333, 0.4423828125, 0.3175130208333334, 0.5266927083333334, 0.5723307291666667, 0.5356119791666667, 0.5291015625000001, 0.5041015624999999, 0.5082682291666667, 0.5506510416666667, 0.5521484375], 
[0.5409895833333334, 0.5096354166666667, 0.41520833333333335, 0.2969791666666666, 0.4999479166666667, 0.54890625, 0.5116666666666666, 0.5040104166666667, 0.48171875000000003, 0.48541666666666666, 0.5257291666666667, 0.5315625], 
[0.5405815972222222, 0.5101996527777778, 0.4148003472222222, 0.29782986111111115, 0.4987413194444444, 0.5473958333333333, 0.5107204861111111, 0.5011284722222222, 0.48055555555555557, 0.4832899305555556, 0.5232638888888889, 0.5290798611111112], 
[0.5385416666666667, 0.5087425595238094, 0.41246279761904764, 0.29531250000000003, 0.4993303571428571, 0.5467633928571428, 0.5109747023809524, 0.5008928571428571, 0.4803199404761904, 0.48344494047619047, 0.5242187500000001, 0.5299107142857143]

]

plot_average_with_error_bars(res, "emotion", "go_emotions")