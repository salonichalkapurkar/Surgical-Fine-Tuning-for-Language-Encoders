Lmod has detected the following error: The following module(s) are unknown:
"conda"

Please check the spelling or version number. Also try "module spider ..."
It is also possible your cache file is out-of-date; it may help to try:
  $ module --ignore_cache load "conda"

Also make sure that all modulefiles written in TCL start with the string
#%Module




CommandNotFoundError: Your shell has not been properly configured to use 'conda activate'.
To initialize your shell, run

    $ conda init <SHELL_NAME>

Currently supported shells are:
  - bash
  - fish
  - tcsh
  - xonsh
  - zsh
  - powershell

See 'conda init --help' for more information and options.

IMPORTANT: You may need to close and restart your shell after running 'conda init'.


######################################################################
layer-wise fine-tuning top 3
Using cuda
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 174.94it/s]
/work/dmpetrov_umass_edu/anaconda3/envs/finetuning/lib/python3.9/site-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
layers to freeze ('bert.encoder.layer.2', 'bert.encoder.layer.4', 'bert.encoder.layer.5', 'bert.encoder.layer.6', 'bert.encoder.layer.7', 'bert.encoder.layer.8', 'bert.encoder.layer.9', 'bert.encoder.layer.10', 'bert.encoder.layer.11')
{'loss': 0.6823, 'learning_rate': 2.5e-06, 'epoch': 0.04}
{'loss': 0.5705, 'learning_rate': 5e-06, 'epoch': 0.09}
{'loss': 0.5096, 'learning_rate': 7.5e-06, 'epoch': 0.13}
{'loss': 0.4701, 'learning_rate': 1e-05, 'epoch': 0.18}
{'loss': 0.4484, 'learning_rate': 1.25e-05, 'epoch': 0.22}
{'loss': 0.4235, 'learning_rate': 1.5e-05, 'epoch': 0.26}
{'loss': 0.4156, 'learning_rate': 1.75e-05, 'epoch': 0.31}
{'loss': 0.4018, 'learning_rate': 2e-05, 'epoch': 0.35}
{'loss': 0.3972, 'learning_rate': 2.25e-05, 'epoch': 0.4}
{'loss': 0.3862, 'learning_rate': 2.5e-05, 'epoch': 0.44}
{'loss': 0.3748, 'learning_rate': 2.7500000000000004e-05, 'epoch': 0.48}
{'loss': 0.3677, 'learning_rate': 3e-05, 'epoch': 0.53}
{'loss': 0.3591, 'learning_rate': 3.2500000000000004e-05, 'epoch': 0.57}
{'loss': 0.3519, 'learning_rate': 3.5e-05, 'epoch': 0.62}
{'loss': 0.3535, 'learning_rate': 3.7500000000000003e-05, 'epoch': 0.66}
{'loss': 0.3598, 'learning_rate': 4e-05, 'epoch': 0.7}
{'loss': 0.3442, 'learning_rate': 4.25e-05, 'epoch': 0.75}
{'loss': 0.3398, 'learning_rate': 4.5e-05, 'epoch': 0.79}
{'loss': 0.333, 'learning_rate': 4.75e-05, 'epoch': 0.84}
{'loss': 0.3223, 'learning_rate': 5e-05, 'epoch': 0.88}
{'loss': 0.3248, 'learning_rate': 4.9758919961427194e-05, 'epoch': 0.92}
{'loss': 0.3231, 'learning_rate': 4.951783992285439e-05, 'epoch': 0.97}
{'eval_loss': 0.3020651638507843, 'eval_accuracy': 0.8674499134306208, 'eval_runtime': 1216.6547, 'eval_samples_per_second': 33.23, 'eval_steps_per_second': 2.077, 'epoch': 1.0}
{'loss': 0.3063, 'learning_rate': 4.9276759884281584e-05, 'epoch': 1.01}
{'loss': 0.2702, 'learning_rate': 4.9035679845708775e-05, 'epoch': 1.06}
{'loss': 0.2725, 'learning_rate': 4.8794599807135974e-05, 'epoch': 1.1}
{'loss': 0.2664, 'learning_rate': 4.8553519768563165e-05, 'epoch': 1.14}
{'loss': 0.2618, 'learning_rate': 4.831243972999036e-05, 'epoch': 1.19}
{'loss': 0.2699, 'learning_rate': 4.8071359691417555e-05, 'epoch': 1.23}
{'loss': 0.2776, 'learning_rate': 4.7830279652844746e-05, 'epoch': 1.28}
{'loss': 0.2754, 'learning_rate': 4.758919961427194e-05, 'epoch': 1.32}
{'loss': 0.2692, 'learning_rate': 4.7348119575699136e-05, 'epoch': 1.36}
{'loss': 0.2651, 'learning_rate': 4.710703953712633e-05, 'epoch': 1.41}
{'loss': 0.2648, 'learning_rate': 4.6865959498553526e-05, 'epoch': 1.45}
{'loss': 0.2633, 'learning_rate': 4.662487945998071e-05, 'epoch': 1.5}
{'loss': 0.2616, 'learning_rate': 4.638379942140791e-05, 'epoch': 1.54}
{'loss': 0.2675, 'learning_rate': 4.61427193828351e-05, 'epoch': 1.58}
{'loss': 0.2669, 'learning_rate': 4.59016393442623e-05, 'epoch': 1.63}
{'loss': 0.2544, 'learning_rate': 4.566055930568949e-05, 'epoch': 1.67}
{'loss': 0.2569, 'learning_rate': 4.541947926711668e-05, 'epoch': 1.71}
{'loss': 0.2527, 'learning_rate': 4.517839922854388e-05, 'epoch': 1.76}
{'loss': 0.2583, 'learning_rate': 4.493731918997107e-05, 'epoch': 1.8}
{'loss': 0.2619, 'learning_rate': 4.469623915139827e-05, 'epoch': 1.85}
{'loss': 0.2569, 'learning_rate': 4.445515911282546e-05, 'epoch': 1.89}
{'loss': 0.256, 'learning_rate': 4.421407907425266e-05, 'epoch': 1.93}
{'loss': 0.2512, 'learning_rate': 4.3972999035679845e-05, 'epoch': 1.98}
{'eval_loss': 0.2678878605365753, 'eval_accuracy': 0.8868167202572347, 'eval_runtime': 1215.4757, 'eval_samples_per_second': 33.263, 'eval_steps_per_second': 2.079, 'epoch': 2.0}
{'loss': 0.2137, 'learning_rate': 4.373191899710704e-05, 'epoch': 2.02}
{'loss': 0.1767, 'learning_rate': 4.3490838958534234e-05, 'epoch': 2.07}
{'loss': 0.1807, 'learning_rate': 4.324975891996143e-05, 'epoch': 2.11}
{'loss': 0.1786, 'learning_rate': 4.3008678881388624e-05, 'epoch': 2.15}
{'loss': 0.1815, 'learning_rate': 4.2767598842815816e-05, 'epoch': 2.2}
{'loss': 0.1855, 'learning_rate': 4.252651880424301e-05, 'epoch': 2.24}
{'loss': 0.1813, 'learning_rate': 4.2285438765670205e-05, 'epoch': 2.29}
{'loss': 0.1834, 'learning_rate': 4.20443587270974e-05, 'epoch': 2.33}
{'loss': 0.1773, 'learning_rate': 4.1803278688524595e-05, 'epoch': 2.37}
{'loss': 0.1805, 'learning_rate': 4.156219864995179e-05, 'epoch': 2.42}
{'loss': 0.1823, 'learning_rate': 4.132111861137898e-05, 'epoch': 2.46}
{'loss': 0.1868, 'learning_rate': 4.108003857280617e-05, 'epoch': 2.51}
{'loss': 0.1858, 'learning_rate': 4.083895853423337e-05, 'epoch': 2.55}
{'loss': 0.1893, 'learning_rate': 4.059787849566056e-05, 'epoch': 2.59}
{'loss': 0.1846, 'learning_rate': 4.035679845708776e-05, 'epoch': 2.64}
{'loss': 0.1839, 'learning_rate': 4.011571841851495e-05, 'epoch': 2.68}
{'loss': 0.189, 'learning_rate': 3.987463837994214e-05, 'epoch': 2.73}
{'loss': 0.1822, 'learning_rate': 3.963355834136934e-05, 'epoch': 2.77}
{'loss': 0.1933, 'learning_rate': 3.939247830279653e-05, 'epoch': 2.81}
{'loss': 0.1859, 'learning_rate': 3.915139826422373e-05, 'epoch': 2.86}
{'loss': 0.1908, 'learning_rate': 3.8910318225650914e-05, 'epoch': 2.9}
{'loss': 0.182, 'learning_rate': 3.866923818707811e-05, 'epoch': 2.95}
{'loss': 0.1869, 'learning_rate': 3.8428158148505304e-05, 'epoch': 2.99}
{'eval_loss': 0.2695712745189667, 'eval_accuracy': 0.8956962651496414, 'eval_runtime': 1215.2351, 'eval_samples_per_second': 33.269, 'eval_steps_per_second': 2.079, 'epoch': 3.0}
{'loss': 0.1345, 'learning_rate': 3.81870781099325e-05, 'epoch': 3.03}
{'loss': 0.1169, 'learning_rate': 3.7945998071359693e-05, 'epoch': 3.08}
{'loss': 0.1239, 'learning_rate': 3.7704918032786885e-05, 'epoch': 3.12}
{'loss': 0.1208, 'learning_rate': 3.7463837994214076e-05, 'epoch': 3.17}
{'loss': 0.1249, 'learning_rate': 3.7222757955641275e-05, 'epoch': 3.21}
{'loss': 0.1242, 'learning_rate': 3.6981677917068466e-05, 'epoch': 3.25}
{'loss': 0.1259, 'learning_rate': 3.6740597878495665e-05, 'epoch': 3.3}
{'loss': 0.1285, 'learning_rate': 3.6499517839922856e-05, 'epoch': 3.34}
{'loss': 0.1313, 'learning_rate': 3.625843780135005e-05, 'epoch': 3.39}
{'loss': 0.127, 'learning_rate': 3.6017357762777246e-05, 'epoch': 3.43}
{'loss': 0.1309, 'learning_rate': 3.577627772420444e-05, 'epoch': 3.47}
{'loss': 0.135, 'learning_rate': 3.5535197685631636e-05, 'epoch': 3.52}
{'loss': 0.1336, 'learning_rate': 3.529411764705883e-05, 'epoch': 3.56}
{'loss': 0.134, 'learning_rate': 3.505303760848602e-05, 'epoch': 3.61}
{'loss': 0.1347, 'learning_rate': 3.481195756991321e-05, 'epoch': 3.65}
{'loss': 0.1393, 'learning_rate': 3.457087753134041e-05, 'epoch': 3.69}
{'loss': 0.1341, 'learning_rate': 3.43297974927676e-05, 'epoch': 3.74}
{'loss': 0.135, 'learning_rate': 3.40887174541948e-05, 'epoch': 3.78}
{'loss': 0.1365, 'learning_rate': 3.384763741562198e-05, 'epoch': 3.83}
{'loss': 0.1342, 'learning_rate': 3.360655737704918e-05, 'epoch': 3.87}
{'loss': 0.1352, 'learning_rate': 3.336547733847637e-05, 'epoch': 3.91}
{'loss': 0.1349, 'learning_rate': 3.312439729990357e-05, 'epoch': 3.96}
{'eval_loss': 0.3193739056587219, 'eval_accuracy': 0.8953499876329458, 'eval_runtime': 1214.8842, 'eval_samples_per_second': 33.279, 'eval_steps_per_second': 2.08, 'epoch': 4.0}
{'loss': 0.138, 'learning_rate': 3.288331726133076e-05, 'epoch': 4.0}
{'loss': 0.0806, 'learning_rate': 3.264223722275796e-05, 'epoch': 4.05}
{'loss': 0.0856, 'learning_rate': 3.2401157184185146e-05, 'epoch': 4.09}
{'loss': 0.0932, 'learning_rate': 3.2160077145612344e-05, 'epoch': 4.13}
{'loss': 0.0915, 'learning_rate': 3.1918997107039536e-05, 'epoch': 4.18}
{'loss': 0.086, 'learning_rate': 3.1677917068466734e-05, 'epoch': 4.22}
{'loss': 0.0913, 'learning_rate': 3.1436837029893925e-05, 'epoch': 4.27}
{'loss': 0.0943, 'learning_rate': 3.119575699132112e-05, 'epoch': 4.31}
{'loss': 0.0975, 'learning_rate': 3.0954676952748315e-05, 'epoch': 4.35}
{'loss': 0.0962, 'learning_rate': 3.071359691417551e-05, 'epoch': 4.4}
{'loss': 0.1003, 'learning_rate': 3.04725168756027e-05, 'epoch': 4.44}
{'loss': 0.0932, 'learning_rate': 3.0231436837029896e-05, 'epoch': 4.49}
{'loss': 0.0958, 'learning_rate': 2.9990356798457088e-05, 'epoch': 4.53}
{'loss': 0.0968, 'learning_rate': 2.9749276759884283e-05, 'epoch': 4.57}
{'loss': 0.1, 'learning_rate': 2.9508196721311478e-05, 'epoch': 4.62}
{'loss': 0.0974, 'learning_rate': 2.9267116682738673e-05, 'epoch': 4.66}
{'loss': 0.0989, 'learning_rate': 2.9026036644165868e-05, 'epoch': 4.71}
{'loss': 0.1032, 'learning_rate': 2.878495660559306e-05, 'epoch': 4.75}
{'loss': 0.093, 'learning_rate': 2.854387656702025e-05, 'epoch': 4.79}
{'loss': 0.1012, 'learning_rate': 2.8302796528447446e-05, 'epoch': 4.84}
{'loss': 0.0974, 'learning_rate': 2.806171648987464e-05, 'epoch': 4.88}
{'loss': 0.0954, 'learning_rate': 2.7820636451301835e-05, 'epoch': 4.93}
{'loss': 0.0969, 'learning_rate': 2.757955641272903e-05, 'epoch': 4.97}
{'eval_loss': 0.38887035846710205, 'eval_accuracy': 0.8969577046747464, 'eval_runtime': 1215.2457, 'eval_samples_per_second': 33.269, 'eval_steps_per_second': 2.079, 'epoch': 5.0}
{'loss': 0.0835, 'learning_rate': 2.733847637415622e-05, 'epoch': 5.01}
{'loss': 0.0703, 'learning_rate': 2.7097396335583413e-05, 'epoch': 5.06}
{'loss': 0.0626, 'learning_rate': 2.6856316297010608e-05, 'epoch': 5.1}
{'loss': 0.0643, 'learning_rate': 2.6615236258437803e-05, 'epoch': 5.14}
{'loss': 0.0699, 'learning_rate': 2.6374156219864998e-05, 'epoch': 5.19}
{'loss': 0.0696, 'learning_rate': 2.6133076181292186e-05, 'epoch': 5.23}
{'loss': 0.0736, 'learning_rate': 2.589199614271938e-05, 'epoch': 5.28}
{'loss': 0.0693, 'learning_rate': 2.5650916104146576e-05, 'epoch': 5.32}
{'loss': 0.073, 'learning_rate': 2.540983606557377e-05, 'epoch': 5.36}
{'loss': 0.0712, 'learning_rate': 2.5168756027000966e-05, 'epoch': 5.41}
{'loss': 0.0683, 'learning_rate': 2.492767598842816e-05, 'epoch': 5.45}
{'loss': 0.0728, 'learning_rate': 2.4686595949855356e-05, 'epoch': 5.5}
{'loss': 0.071, 'learning_rate': 2.4445515911282547e-05, 'epoch': 5.54}
{'loss': 0.069, 'learning_rate': 2.4204435872709742e-05, 'epoch': 5.58}
{'loss': 0.074, 'learning_rate': 2.3963355834136937e-05, 'epoch': 5.63}
{'loss': 0.0661, 'learning_rate': 2.372227579556413e-05, 'epoch': 5.67}
{'loss': 0.0807, 'learning_rate': 2.3481195756991323e-05, 'epoch': 5.72}
{'loss': 0.0771, 'learning_rate': 2.3240115718418515e-05, 'epoch': 5.76}
{'loss': 0.0703, 'learning_rate': 2.299903567984571e-05, 'epoch': 5.8}
{'loss': 0.0776, 'learning_rate': 2.2757955641272905e-05, 'epoch': 5.85}
{'loss': 0.0768, 'learning_rate': 2.2516875602700096e-05, 'epoch': 5.89}
{'loss': 0.0722, 'learning_rate': 2.227579556412729e-05, 'epoch': 5.94}
{'loss': 0.0761, 'learning_rate': 2.2034715525554486e-05, 'epoch': 5.98}
{'eval_loss': 0.4214056730270386, 'eval_accuracy': 0.8986148899332179, 'eval_runtime': 1215.6178, 'eval_samples_per_second': 33.259, 'eval_steps_per_second': 2.079, 'epoch': 6.0}
{'loss': 0.0574, 'learning_rate': 2.1793635486981678e-05, 'epoch': 6.02}
{'loss': 0.0468, 'learning_rate': 2.1552555448408872e-05, 'epoch': 6.07}
{'loss': 0.0524, 'learning_rate': 2.1311475409836064e-05, 'epoch': 6.11}
{'loss': 0.0523, 'learning_rate': 2.107039537126326e-05, 'epoch': 6.16}
{'loss': 0.0485, 'learning_rate': 2.0829315332690454e-05, 'epoch': 6.2}
{'loss': 0.0522, 'learning_rate': 2.058823529411765e-05, 'epoch': 6.24}
{'loss': 0.0517, 'learning_rate': 2.0347155255544844e-05, 'epoch': 6.29}
{'loss': 0.0528, 'learning_rate': 2.010607521697204e-05, 'epoch': 6.33}
{'loss': 0.055, 'learning_rate': 1.986499517839923e-05, 'epoch': 6.38}
{'loss': 0.0543, 'learning_rate': 1.9623915139826425e-05, 'epoch': 6.42}
{'loss': 0.0611, 'learning_rate': 1.9382835101253616e-05, 'epoch': 6.46}
{'loss': 0.0538, 'learning_rate': 1.914175506268081e-05, 'epoch': 6.51}
{'loss': 0.0548, 'learning_rate': 1.8900675024108006e-05, 'epoch': 6.55}
{'loss': 0.052, 'learning_rate': 1.8659594985535198e-05, 'epoch': 6.6}
{'loss': 0.0558, 'learning_rate': 1.8418514946962393e-05, 'epoch': 6.64}
{'loss': 0.0509, 'learning_rate': 1.8177434908389588e-05, 'epoch': 6.68}
{'loss': 0.0569, 'learning_rate': 1.793635486981678e-05, 'epoch': 6.73}
{'loss': 0.0565, 'learning_rate': 1.7695274831243974e-05, 'epoch': 6.77}
{'loss': 0.0584, 'learning_rate': 1.7454194792671165e-05, 'epoch': 6.82}
{'loss': 0.0538, 'learning_rate': 1.721311475409836e-05, 'epoch': 6.86}
{'loss': 0.0582, 'learning_rate': 1.6972034715525555e-05, 'epoch': 6.9}
{'loss': 0.0582, 'learning_rate': 1.6730954676952747e-05, 'epoch': 6.95}
{'loss': 0.0576, 'learning_rate': 1.6489874638379942e-05, 'epoch': 6.99}
{'eval_loss': 0.5040934681892395, 'eval_accuracy': 0.8992579767499381, 'eval_runtime': 1215.7507, 'eval_samples_per_second': 33.255, 'eval_steps_per_second': 2.079, 'epoch': 7.0}
{'loss': 0.0354, 'learning_rate': 1.6248794599807137e-05, 'epoch': 7.04}
{'loss': 0.0375, 'learning_rate': 1.600771456123433e-05, 'epoch': 7.08}
{'loss': 0.04, 'learning_rate': 1.5766634522661526e-05, 'epoch': 7.12}
{'loss': 0.0316, 'learning_rate': 1.5525554484088718e-05, 'epoch': 7.17}
{'loss': 0.0381, 'learning_rate': 1.5284474445515913e-05, 'epoch': 7.21}
{'loss': 0.0337, 'learning_rate': 1.5043394406943106e-05, 'epoch': 7.26}
{'loss': 0.0396, 'learning_rate': 1.48023143683703e-05, 'epoch': 7.3}
{'loss': 0.0408, 'learning_rate': 1.4561234329797494e-05, 'epoch': 7.34}
{'loss': 0.0366, 'learning_rate': 1.4320154291224689e-05, 'epoch': 7.39}
{'loss': 0.0386, 'learning_rate': 1.407907425265188e-05, 'epoch': 7.43}
{'loss': 0.0419, 'learning_rate': 1.3837994214079075e-05, 'epoch': 7.48}
{'loss': 0.0365, 'learning_rate': 1.359691417550627e-05, 'epoch': 7.52}
{'loss': 0.0361, 'learning_rate': 1.3355834136933462e-05, 'epoch': 7.56}
{'loss': 0.0397, 'learning_rate': 1.3114754098360657e-05, 'epoch': 7.61}
{'loss': 0.0454, 'learning_rate': 1.2873674059787848e-05, 'epoch': 7.65}
{'loss': 0.0355, 'learning_rate': 1.2632594021215043e-05, 'epoch': 7.7}
{'loss': 0.0428, 'learning_rate': 1.2391513982642238e-05, 'epoch': 7.74}
{'loss': 0.0377, 'learning_rate': 1.2150433944069433e-05, 'epoch': 7.78}
{'loss': 0.0367, 'learning_rate': 1.1909353905496626e-05, 'epoch': 7.83}
{'loss': 0.0373, 'learning_rate': 1.166827386692382e-05, 'epoch': 7.87}
{'loss': 0.0407, 'learning_rate': 1.1427193828351013e-05, 'epoch': 7.92}
{'loss': 0.0419, 'learning_rate': 1.1186113789778208e-05, 'epoch': 7.96}
{'eval_loss': 0.5688885450363159, 'eval_accuracy': 0.9006183527083849, 'eval_runtime': 1215.9975, 'eval_samples_per_second': 33.248, 'eval_steps_per_second': 2.078, 'epoch': 8.0}
{'loss': 0.0364, 'learning_rate': 1.09450337512054e-05, 'epoch': 8.0}
{'loss': 0.0219, 'learning_rate': 1.0703953712632594e-05, 'epoch': 8.05}
{'loss': 0.0253, 'learning_rate': 1.0462873674059787e-05, 'epoch': 8.09}
{'loss': 0.0291, 'learning_rate': 1.0221793635486982e-05, 'epoch': 8.14}
{'loss': 0.0278, 'learning_rate': 9.980713596914177e-06, 'epoch': 8.18}
{'loss': 0.0277, 'learning_rate': 9.73963355834137e-06, 'epoch': 8.22}
{'loss': 0.0258, 'learning_rate': 9.498553519768563e-06, 'epoch': 8.27}
{'loss': 0.021, 'learning_rate': 9.257473481195758e-06, 'epoch': 8.31}
{'loss': 0.033, 'learning_rate': 9.016393442622952e-06, 'epoch': 8.35}
{'loss': 0.0281, 'learning_rate': 8.775313404050145e-06, 'epoch': 8.4}
{'loss': 0.0273, 'learning_rate': 8.534233365477338e-06, 'epoch': 8.44}
{'loss': 0.0329, 'learning_rate': 8.293153326904533e-06, 'epoch': 8.49}
{'loss': 0.0287, 'learning_rate': 8.052073288331726e-06, 'epoch': 8.53}
{'loss': 0.0304, 'learning_rate': 7.810993249758921e-06, 'epoch': 8.57}
{'loss': 0.024, 'learning_rate': 7.569913211186113e-06, 'epoch': 8.62}
{'loss': 0.0273, 'learning_rate': 7.328833172613308e-06, 'epoch': 8.66}
{'loss': 0.0317, 'learning_rate': 7.087753134040502e-06, 'epoch': 8.71}
{'loss': 0.0247, 'learning_rate': 6.8466730954676955e-06, 'epoch': 8.75}
{'loss': 0.0304, 'learning_rate': 6.605593056894889e-06, 'epoch': 8.79}
{'loss': 0.0312, 'learning_rate': 6.364513018322084e-06, 'epoch': 8.84}
{'loss': 0.0274, 'learning_rate': 6.123432979749278e-06, 'epoch': 8.88}
{'loss': 0.0276, 'learning_rate': 5.882352941176471e-06, 'epoch': 8.93}
{'loss': 0.029, 'learning_rate': 5.641272902603665e-06, 'epoch': 8.97}
{'eval_loss': 0.6150392889976501, 'eval_accuracy': 0.9017313875834776, 'eval_runtime': 1216.0048, 'eval_samples_per_second': 33.248, 'eval_steps_per_second': 2.078, 'epoch': 9.0}
{'loss': 0.0257, 'learning_rate': 5.400192864030858e-06, 'epoch': 9.01}
{'loss': 0.0162, 'learning_rate': 5.159112825458052e-06, 'epoch': 9.06}
{'loss': 0.0184, 'learning_rate': 4.918032786885246e-06, 'epoch': 9.1}
{'loss': 0.0186, 'learning_rate': 4.67695274831244e-06, 'epoch': 9.15}
{'loss': 0.0212, 'learning_rate': 4.4358727097396336e-06, 'epoch': 9.19}
{'loss': 0.018, 'learning_rate': 4.194792671166828e-06, 'epoch': 9.23}
{'loss': 0.0254, 'learning_rate': 3.953712632594022e-06, 'epoch': 9.28}
{'loss': 0.0144, 'learning_rate': 3.7126325940212153e-06, 'epoch': 9.32}
{'loss': 0.0176, 'learning_rate': 3.471552555448409e-06, 'epoch': 9.37}
{'loss': 0.02, 'learning_rate': 3.230472516875603e-06, 'epoch': 9.41}
{'loss': 0.0181, 'learning_rate': 2.9893924783027966e-06, 'epoch': 9.45}
{'loss': 0.0195, 'learning_rate': 2.7483124397299903e-06, 'epoch': 9.5}
{'loss': 0.0201, 'learning_rate': 2.5072324011571843e-06, 'epoch': 9.54}
{'loss': 0.0195, 'learning_rate': 2.266152362584378e-06, 'epoch': 9.59}
{'loss': 0.0186, 'learning_rate': 2.0250723240115716e-06, 'epoch': 9.63}
{'loss': 0.0175, 'learning_rate': 1.7839922854387657e-06, 'epoch': 9.67}
{'loss': 0.02, 'learning_rate': 1.5429122468659597e-06, 'epoch': 9.72}
{'loss': 0.018, 'learning_rate': 1.3018322082931534e-06, 'epoch': 9.76}
{'loss': 0.017, 'learning_rate': 1.0607521697203472e-06, 'epoch': 9.81}
{'loss': 0.019, 'learning_rate': 8.19672131147541e-07, 'epoch': 9.85}
{'loss': 0.0224, 'learning_rate': 5.785920925747349e-07, 'epoch': 9.89}
{'loss': 0.0178, 'learning_rate': 3.3751205400192864e-07, 'epoch': 9.94}
{'loss': 0.0198, 'learning_rate': 9.643201542912248e-08, 'epoch': 9.98}
{'eval_loss': 0.6809312105178833, 'eval_accuracy': 0.9012614395251051, 'eval_runtime': 1236.5905, 'eval_samples_per_second': 32.695, 'eval_steps_per_second': 2.044, 'epoch': 10.0}
{'train_runtime': 277623.6166, 'train_samples_per_second': 13.106, 'train_steps_per_second': 0.41, 'train_loss': 0.12832431114233683, 'epoch': 10.0}
Total training time: 277623.74 seconds
######################################################################
layer-wise fine-tuning top 4
Using cuda
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 157.16it/s]
/work/dmpetrov_umass_edu/anaconda3/envs/finetuning/lib/python3.9/site-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
layers to freeze ('bert.encoder.layer.4', 'bert.encoder.layer.5', 'bert.encoder.layer.6', 'bert.encoder.layer.7', 'bert.encoder.layer.8', 'bert.encoder.layer.9', 'bert.encoder.layer.10', 'bert.encoder.layer.11')
{'loss': 0.6815, 'learning_rate': 2.5e-06, 'epoch': 0.04}
{'loss': 0.5586, 'learning_rate': 5e-06, 'epoch': 0.09}
{'loss': 0.5, 'learning_rate': 7.5e-06, 'epoch': 0.13}
{'loss': 0.4612, 'learning_rate': 1e-05, 'epoch': 0.18}
{'loss': 0.4378, 'learning_rate': 1.25e-05, 'epoch': 0.22}
{'loss': 0.413, 'learning_rate': 1.5e-05, 'epoch': 0.26}
{'loss': 0.4073, 'learning_rate': 1.75e-05, 'epoch': 0.31}
{'loss': 0.3928, 'learning_rate': 2e-05, 'epoch': 0.35}
{'loss': 0.3902, 'learning_rate': 2.25e-05, 'epoch': 0.4}
{'loss': 0.3795, 'learning_rate': 2.5e-05, 'epoch': 0.44}
{'loss': 0.3666, 'learning_rate': 2.7500000000000004e-05, 'epoch': 0.48}
{'loss': 0.3596, 'learning_rate': 3e-05, 'epoch': 0.53}
{'loss': 0.3506, 'learning_rate': 3.2500000000000004e-05, 'epoch': 0.57}
{'loss': 0.3425, 'learning_rate': 3.5e-05, 'epoch': 0.62}
{'loss': 0.3427, 'learning_rate': 3.7500000000000003e-05, 'epoch': 0.66}
{'loss': 0.351, 'learning_rate': 4e-05, 'epoch': 0.7}
{'loss': 0.3344, 'learning_rate': 4.25e-05, 'epoch': 0.75}
{'loss': 0.333, 'learning_rate': 4.5e-05, 'epoch': 0.79}
{'loss': 0.3261, 'learning_rate': 4.75e-05, 'epoch': 0.84}
{'loss': 0.3196, 'learning_rate': 5e-05, 'epoch': 0.88}
{'loss': 0.3166, 'learning_rate': 4.9758919961427194e-05, 'epoch': 0.92}
{'loss': 0.3166, 'learning_rate': 4.951783992285439e-05, 'epoch': 0.97}
{'eval_loss': 0.31502482295036316, 'eval_accuracy': 0.8629483057135791, 'eval_runtime': 1241.2213, 'eval_samples_per_second': 32.573, 'eval_steps_per_second': 2.036, 'epoch': 1.0}
{'loss': 0.2996, 'learning_rate': 4.9276759884281584e-05, 'epoch': 1.01}
{'loss': 0.2623, 'learning_rate': 4.9035679845708775e-05, 'epoch': 1.06}
{'loss': 0.2699, 'learning_rate': 4.8794599807135974e-05, 'epoch': 1.1}
{'loss': 0.2621, 'learning_rate': 4.8553519768563165e-05, 'epoch': 1.14}
{'loss': 0.258, 'learning_rate': 4.831243972999036e-05, 'epoch': 1.19}
{'loss': 0.2642, 'learning_rate': 4.8071359691417555e-05, 'epoch': 1.23}
{'loss': 0.2697, 'learning_rate': 4.7830279652844746e-05, 'epoch': 1.28}
{'loss': 0.271, 'learning_rate': 4.758919961427194e-05, 'epoch': 1.32}
{'loss': 0.2634, 'learning_rate': 4.7348119575699136e-05, 'epoch': 1.36}
{'loss': 0.2614, 'learning_rate': 4.710703953712633e-05, 'epoch': 1.41}
{'loss': 0.2596, 'learning_rate': 4.6865959498553526e-05, 'epoch': 1.45}
{'loss': 0.2575, 'learning_rate': 4.662487945998071e-05, 'epoch': 1.5}
{'loss': 0.2607, 'learning_rate': 4.638379942140791e-05, 'epoch': 1.54}
{'loss': 0.2601, 'learning_rate': 4.61427193828351e-05, 'epoch': 1.58}
{'loss': 0.2645, 'learning_rate': 4.59016393442623e-05, 'epoch': 1.63}
{'loss': 0.2528, 'learning_rate': 4.566055930568949e-05, 'epoch': 1.67}
{'loss': 0.2583, 'learning_rate': 4.541947926711668e-05, 'epoch': 1.71}
{'loss': 0.25, 'learning_rate': 4.517839922854388e-05, 'epoch': 1.76}
{'loss': 0.2552, 'learning_rate': 4.493731918997107e-05, 'epoch': 1.8}
{'loss': 0.2585, 'learning_rate': 4.469623915139827e-05, 'epoch': 1.85}
{'loss': 0.2558, 'learning_rate': 4.445515911282546e-05, 'epoch': 1.89}
{'loss': 0.2547, 'learning_rate': 4.421407907425266e-05, 'epoch': 1.93}
{'loss': 0.2483, 'learning_rate': 4.3972999035679845e-05, 'epoch': 1.98}
{'eval_loss': 0.27481532096862793, 'eval_accuracy': 0.8861241652238436, 'eval_runtime': 1215.1906, 'eval_samples_per_second': 33.271, 'eval_steps_per_second': 2.08, 'epoch': 2.0}
{'loss': 0.2137, 'learning_rate': 4.373191899710704e-05, 'epoch': 2.02}
{'loss': 0.172, 'learning_rate': 4.3490838958534234e-05, 'epoch': 2.07}
{'loss': 0.1727, 'learning_rate': 4.324975891996143e-05, 'epoch': 2.11}
{'loss': 0.1803, 'learning_rate': 4.3008678881388624e-05, 'epoch': 2.15}
{'loss': 0.1775, 'learning_rate': 4.2767598842815816e-05, 'epoch': 2.2}
{'loss': 0.181, 'learning_rate': 4.252651880424301e-05, 'epoch': 2.24}
{'loss': 0.1758, 'learning_rate': 4.2285438765670205e-05, 'epoch': 2.29}
{'loss': 0.1785, 'learning_rate': 4.20443587270974e-05, 'epoch': 2.33}
{'loss': 0.1816, 'learning_rate': 4.1803278688524595e-05, 'epoch': 2.37}
{'loss': 0.1803, 'learning_rate': 4.156219864995179e-05, 'epoch': 2.42}
{'loss': 0.1793, 'learning_rate': 4.132111861137898e-05, 'epoch': 2.46}
{'loss': 0.1804, 'learning_rate': 4.108003857280617e-05, 'epoch': 2.51}
{'loss': 0.1831, 'learning_rate': 4.083895853423337e-05, 'epoch': 2.55}
{'loss': 0.1859, 'learning_rate': 4.059787849566056e-05, 'epoch': 2.59}
{'loss': 0.1801, 'learning_rate': 4.035679845708776e-05, 'epoch': 2.64}
{'loss': 0.1834, 'learning_rate': 4.011571841851495e-05, 'epoch': 2.68}
{'loss': 0.1829, 'learning_rate': 3.987463837994214e-05, 'epoch': 2.73}
{'loss': 0.1784, 'learning_rate': 3.963355834136934e-05, 'epoch': 2.77}
{'loss': 0.1864, 'learning_rate': 3.939247830279653e-05, 'epoch': 2.81}
{'loss': 0.1856, 'learning_rate': 3.915139826422373e-05, 'epoch': 2.86}
{'loss': 0.1843, 'learning_rate': 3.8910318225650914e-05, 'epoch': 2.9}
{'loss': 0.177, 'learning_rate': 3.866923818707811e-05, 'epoch': 2.95}
{'loss': 0.1849, 'learning_rate': 3.8428158148505304e-05, 'epoch': 2.99}
{'eval_loss': 0.27239224314689636, 'eval_accuracy': 0.894731634924561, 'eval_runtime': 1214.2323, 'eval_samples_per_second': 33.297, 'eval_steps_per_second': 2.081, 'epoch': 3.0}
{'loss': 0.1309, 'learning_rate': 3.81870781099325e-05, 'epoch': 3.03}
{'loss': 0.1128, 'learning_rate': 3.7945998071359693e-05, 'epoch': 3.08}
{'loss': 0.1232, 'learning_rate': 3.7704918032786885e-05, 'epoch': 3.12}
{'loss': 0.1188, 'learning_rate': 3.7463837994214076e-05, 'epoch': 3.17}
{'loss': 0.1267, 'learning_rate': 3.7222757955641275e-05, 'epoch': 3.21}
{'loss': 0.119, 'learning_rate': 3.6981677917068466e-05, 'epoch': 3.25}
{'loss': 0.1189, 'learning_rate': 3.6740597878495665e-05, 'epoch': 3.3}
{'loss': 0.126, 'learning_rate': 3.6499517839922856e-05, 'epoch': 3.34}
{'loss': 0.1244, 'learning_rate': 3.625843780135005e-05, 'epoch': 3.39}
{'loss': 0.1234, 'learning_rate': 3.6017357762777246e-05, 'epoch': 3.43}
{'loss': 0.131, 'learning_rate': 3.577627772420444e-05, 'epoch': 3.47}
{'loss': 0.1328, 'learning_rate': 3.5535197685631636e-05, 'epoch': 3.52}
{'loss': 0.1285, 'learning_rate': 3.529411764705883e-05, 'epoch': 3.56}
{'loss': 0.133, 'learning_rate': 3.505303760848602e-05, 'epoch': 3.61}
{'loss': 0.1275, 'learning_rate': 3.481195756991321e-05, 'epoch': 3.65}
{'loss': 0.1358, 'learning_rate': 3.457087753134041e-05, 'epoch': 3.69}
{'loss': 0.1276, 'learning_rate': 3.43297974927676e-05, 'epoch': 3.74}
{'loss': 0.1288, 'learning_rate': 3.40887174541948e-05, 'epoch': 3.78}
{'loss': 0.1282, 'learning_rate': 3.384763741562198e-05, 'epoch': 3.83}
{'loss': 0.1344, 'learning_rate': 3.360655737704918e-05, 'epoch': 3.87}
{'loss': 0.1353, 'learning_rate': 3.336547733847637e-05, 'epoch': 3.91}
{'loss': 0.1322, 'learning_rate': 3.312439729990357e-05, 'epoch': 3.96}
{'eval_loss': 0.3204439878463745, 'eval_accuracy': 0.8972050457581005, 'eval_runtime': 1222.8241, 'eval_samples_per_second': 33.063, 'eval_steps_per_second': 2.067, 'epoch': 4.0}
{'loss': 0.133, 'learning_rate': 3.288331726133076e-05, 'epoch': 4.0}
{'loss': 0.0776, 'learning_rate': 3.264223722275796e-05, 'epoch': 4.05}
{'loss': 0.0824, 'learning_rate': 3.2401157184185146e-05, 'epoch': 4.09}
{'loss': 0.0898, 'learning_rate': 3.2160077145612344e-05, 'epoch': 4.13}
{'loss': 0.0854, 'learning_rate': 3.1918997107039536e-05, 'epoch': 4.18}
{'loss': 0.0825, 'learning_rate': 3.1677917068466734e-05, 'epoch': 4.22}
{'loss': 0.0871, 'learning_rate': 3.1436837029893925e-05, 'epoch': 4.27}
{'loss': 0.0961, 'learning_rate': 3.119575699132112e-05, 'epoch': 4.31}
{'loss': 0.0931, 'learning_rate': 3.0954676952748315e-05, 'epoch': 4.35}
{'loss': 0.0983, 'learning_rate': 3.071359691417551e-05, 'epoch': 4.4}
{'loss': 0.0962, 'learning_rate': 3.04725168756027e-05, 'epoch': 4.44}
{'loss': 0.094, 'learning_rate': 3.0231436837029896e-05, 'epoch': 4.49}
{'loss': 0.0909, 'learning_rate': 2.9990356798457088e-05, 'epoch': 4.53}
{'loss': 0.1006, 'learning_rate': 2.9749276759884283e-05, 'epoch': 4.57}
{'loss': 0.0951, 'learning_rate': 2.9508196721311478e-05, 'epoch': 4.62}
{'loss': 0.0976, 'learning_rate': 2.9267116682738673e-05, 'epoch': 4.66}
{'loss': 0.0941, 'learning_rate': 2.9026036644165868e-05, 'epoch': 4.71}
{'loss': 0.0984, 'learning_rate': 2.878495660559306e-05, 'epoch': 4.75}
{'loss': 0.0919, 'learning_rate': 2.854387656702025e-05, 'epoch': 4.79}
{'loss': 0.1009, 'learning_rate': 2.8302796528447446e-05, 'epoch': 4.84}
{'loss': 0.0918, 'learning_rate': 2.806171648987464e-05, 'epoch': 4.88}
{'loss': 0.0961, 'learning_rate': 2.7820636451301835e-05, 'epoch': 4.93}
{'loss': 0.0933, 'learning_rate': 2.757955641272903e-05, 'epoch': 4.97}
{'eval_loss': 0.3958404064178467, 'eval_accuracy': 0.8974523868414543, 'eval_runtime': 1224.2572, 'eval_samples_per_second': 33.024, 'eval_steps_per_second': 2.064, 'epoch': 5.0}
{'loss': 0.0848, 'learning_rate': 2.733847637415622e-05, 'epoch': 5.01}
{'loss': 0.0637, 'learning_rate': 2.7097396335583413e-05, 'epoch': 5.06}
{'loss': 0.0625, 'learning_rate': 2.6856316297010608e-05, 'epoch': 5.1}
{'loss': 0.0633, 'learning_rate': 2.6615236258437803e-05, 'epoch': 5.14}
{'loss': 0.0646, 'learning_rate': 2.6374156219864998e-05, 'epoch': 5.19}
{'loss': 0.0648, 'learning_rate': 2.6133076181292186e-05, 'epoch': 5.23}
{'loss': 0.0711, 'learning_rate': 2.589199614271938e-05, 'epoch': 5.28}
{'loss': 0.0645, 'learning_rate': 2.5650916104146576e-05, 'epoch': 5.32}
{'loss': 0.0676, 'learning_rate': 2.540983606557377e-05, 'epoch': 5.36}
{'loss': 0.0707, 'learning_rate': 2.5168756027000966e-05, 'epoch': 5.41}
{'loss': 0.07, 'learning_rate': 2.492767598842816e-05, 'epoch': 5.45}
{'loss': 0.0681, 'learning_rate': 2.4686595949855356e-05, 'epoch': 5.5}
{'loss': 0.0664, 'learning_rate': 2.4445515911282547e-05, 'epoch': 5.54}
{'loss': 0.065, 'learning_rate': 2.4204435872709742e-05, 'epoch': 5.58}
{'loss': 0.0674, 'learning_rate': 2.3963355834136937e-05, 'epoch': 5.63}
{'loss': 0.0682, 'learning_rate': 2.372227579556413e-05, 'epoch': 5.67}
{'loss': 0.0729, 'learning_rate': 2.3481195756991323e-05, 'epoch': 5.72}
{'loss': 0.0752, 'learning_rate': 2.3240115718418515e-05, 'epoch': 5.76}
{'loss': 0.0693, 'learning_rate': 2.299903567984571e-05, 'epoch': 5.8}
{'loss': 0.0719, 'learning_rate': 2.2757955641272905e-05, 'epoch': 5.85}
{'loss': 0.0736, 'learning_rate': 2.2516875602700096e-05, 'epoch': 5.89}
{'loss': 0.0673, 'learning_rate': 2.227579556412729e-05, 'epoch': 5.94}
{'loss': 0.0748, 'learning_rate': 2.2034715525554486e-05, 'epoch': 5.98}
{'eval_loss': 0.4252922534942627, 'eval_accuracy': 0.8969577046747464, 'eval_runtime': 1224.0488, 'eval_samples_per_second': 33.03, 'eval_steps_per_second': 2.064, 'epoch': 6.0}
{'loss': 0.0562, 'learning_rate': 2.1793635486981678e-05, 'epoch': 6.02}
{'loss': 0.0432, 'learning_rate': 2.1552555448408872e-05, 'epoch': 6.07}
{'loss': 0.0497, 'learning_rate': 2.1311475409836064e-05, 'epoch': 6.11}
{'loss': 0.048, 'learning_rate': 2.107039537126326e-05, 'epoch': 6.16}
{'loss': 0.0419, 'learning_rate': 2.0829315332690454e-05, 'epoch': 6.2}
{'loss': 0.0498, 'learning_rate': 2.058823529411765e-05, 'epoch': 6.24}
{'loss': 0.0513, 'learning_rate': 2.0347155255544844e-05, 'epoch': 6.29}
{'loss': 0.0493, 'learning_rate': 2.010607521697204e-05, 'epoch': 6.33}
{'loss': 0.0511, 'learning_rate': 1.986499517839923e-05, 'epoch': 6.38}
{'loss': 0.0502, 'learning_rate': 1.9623915139826425e-05, 'epoch': 6.42}
{'loss': 0.0508, 'learning_rate': 1.9382835101253616e-05, 'epoch': 6.46}
{'loss': 0.0543, 'learning_rate': 1.914175506268081e-05, 'epoch': 6.51}
{'loss': 0.0551, 'learning_rate': 1.8900675024108006e-05, 'epoch': 6.55}
{'loss': 0.0526, 'learning_rate': 1.8659594985535198e-05, 'epoch': 6.6}
{'loss': 0.0549, 'learning_rate': 1.8418514946962393e-05, 'epoch': 6.64}
{'loss': 0.0442, 'learning_rate': 1.8177434908389588e-05, 'epoch': 6.68}
{'loss': 0.0568, 'learning_rate': 1.793635486981678e-05, 'epoch': 6.73}
{'loss': 0.0451, 'learning_rate': 1.7695274831243974e-05, 'epoch': 6.77}
{'loss': 0.0514, 'learning_rate': 1.7454194792671165e-05, 'epoch': 6.82}
{'loss': 0.0499, 'learning_rate': 1.721311475409836e-05, 'epoch': 6.86}
{'loss': 0.0519, 'learning_rate': 1.6972034715525555e-05, 'epoch': 6.9}
{'loss': 0.0519, 'learning_rate': 1.6730954676952747e-05, 'epoch': 6.95}
{'loss': 0.0524, 'learning_rate': 1.6489874638379942e-05, 'epoch': 6.99}
{'eval_loss': 0.5483934879302979, 'eval_accuracy': 0.8985654217165471, 'eval_runtime': 1224.8445, 'eval_samples_per_second': 33.008, 'eval_steps_per_second': 2.063, 'epoch': 7.0}
{'loss': 0.0371, 'learning_rate': 1.6248794599807137e-05, 'epoch': 7.04}
{'loss': 0.0332, 'learning_rate': 1.600771456123433e-05, 'epoch': 7.08}
{'loss': 0.0364, 'learning_rate': 1.5766634522661526e-05, 'epoch': 7.12}
{'loss': 0.0334, 'learning_rate': 1.5525554484088718e-05, 'epoch': 7.17}
{'loss': 0.0338, 'learning_rate': 1.5284474445515913e-05, 'epoch': 7.21}
{'loss': 0.0319, 'learning_rate': 1.5043394406943106e-05, 'epoch': 7.26}
{'loss': 0.034, 'learning_rate': 1.48023143683703e-05, 'epoch': 7.3}
{'loss': 0.0342, 'learning_rate': 1.4561234329797494e-05, 'epoch': 7.34}
{'loss': 0.0317, 'learning_rate': 1.4320154291224689e-05, 'epoch': 7.39}
{'loss': 0.0333, 'learning_rate': 1.407907425265188e-05, 'epoch': 7.43}
{'loss': 0.0426, 'learning_rate': 1.3837994214079075e-05, 'epoch': 7.48}
{'loss': 0.0315, 'learning_rate': 1.359691417550627e-05, 'epoch': 7.52}
{'loss': 0.0331, 'learning_rate': 1.3355834136933462e-05, 'epoch': 7.56}
{'loss': 0.037, 'learning_rate': 1.3114754098360657e-05, 'epoch': 7.61}
{'loss': 0.0404, 'learning_rate': 1.2873674059787848e-05, 'epoch': 7.65}
{'loss': 0.0325, 'learning_rate': 1.2632594021215043e-05, 'epoch': 7.7}
{'loss': 0.0405, 'learning_rate': 1.2391513982642238e-05, 'epoch': 7.74}
{'loss': 0.0325, 'learning_rate': 1.2150433944069433e-05, 'epoch': 7.78}
{'loss': 0.0346, 'learning_rate': 1.1909353905496626e-05, 'epoch': 7.83}
{'loss': 0.0342, 'learning_rate': 1.166827386692382e-05, 'epoch': 7.87}
{'loss': 0.0374, 'learning_rate': 1.1427193828351013e-05, 'epoch': 7.92}
{'loss': 0.0353, 'learning_rate': 1.1186113789778208e-05, 'epoch': 7.96}
{'eval_loss': 0.597689688205719, 'eval_accuracy': 0.8986396240415533, 'eval_runtime': 1224.7098, 'eval_samples_per_second': 33.012, 'eval_steps_per_second': 2.063, 'epoch': 8.0}
{'loss': 0.0327, 'learning_rate': 1.09450337512054e-05, 'epoch': 8.0}
{'loss': 0.0265, 'learning_rate': 1.0703953712632594e-05, 'epoch': 8.05}
{'loss': 0.0179, 'learning_rate': 1.0462873674059787e-05, 'epoch': 8.09}
{'loss': 0.0228, 'learning_rate': 1.0221793635486982e-05, 'epoch': 8.14}
{'loss': 0.0267, 'learning_rate': 9.980713596914177e-06, 'epoch': 8.18}
{'loss': 0.0211, 'learning_rate': 9.73963355834137e-06, 'epoch': 8.22}
{'loss': 0.0212, 'learning_rate': 9.498553519768563e-06, 'epoch': 8.27}
{'loss': 0.0222, 'learning_rate': 9.257473481195758e-06, 'epoch': 8.31}
{'loss': 0.0258, 'learning_rate': 9.016393442622952e-06, 'epoch': 8.35}
{'loss': 0.0221, 'learning_rate': 8.775313404050145e-06, 'epoch': 8.4}
{'loss': 0.0254, 'learning_rate': 8.534233365477338e-06, 'epoch': 8.44}
{'loss': 0.0232, 'learning_rate': 8.293153326904533e-06, 'epoch': 8.49}
{'loss': 0.0246, 'learning_rate': 8.052073288331726e-06, 'epoch': 8.53}
{'loss': 0.0234, 'learning_rate': 7.810993249758921e-06, 'epoch': 8.57}
{'loss': 0.0257, 'learning_rate': 7.569913211186113e-06, 'epoch': 8.62}
{'loss': 0.0229, 'learning_rate': 7.328833172613308e-06, 'epoch': 8.66}
{'loss': 0.0261, 'learning_rate': 7.087753134040502e-06, 'epoch': 8.71}
{'loss': 0.0219, 'learning_rate': 6.8466730954676955e-06, 'epoch': 8.75}
{'loss': 0.0247, 'learning_rate': 6.605593056894889e-06, 'epoch': 8.79}
{'loss': 0.0243, 'learning_rate': 6.364513018322084e-06, 'epoch': 8.84}
{'loss': 0.0265, 'learning_rate': 6.123432979749278e-06, 'epoch': 8.88}
{'loss': 0.0194, 'learning_rate': 5.882352941176471e-06, 'epoch': 8.93}
{'loss': 0.023, 'learning_rate': 5.641272902603665e-06, 'epoch': 8.97}
{'eval_loss': 0.6280192732810974, 'eval_accuracy': 0.9002720751916894, 'eval_runtime': 1225.5795, 'eval_samples_per_second': 32.988, 'eval_steps_per_second': 2.062, 'epoch': 9.0}
{'loss': 0.0221, 'learning_rate': 5.400192864030858e-06, 'epoch': 9.01}
{'loss': 0.0136, 'learning_rate': 5.159112825458052e-06, 'epoch': 9.06}
{'loss': 0.0141, 'learning_rate': 4.918032786885246e-06, 'epoch': 9.1}
{'loss': 0.0144, 'learning_rate': 4.67695274831244e-06, 'epoch': 9.15}
{'loss': 0.0139, 'learning_rate': 4.4358727097396336e-06, 'epoch': 9.19}
{'loss': 0.0167, 'learning_rate': 4.194792671166828e-06, 'epoch': 9.23}
{'loss': 0.0173, 'learning_rate': 3.953712632594022e-06, 'epoch': 9.28}
{'loss': 0.0134, 'learning_rate': 3.7126325940212153e-06, 'epoch': 9.32}
{'loss': 0.015, 'learning_rate': 3.471552555448409e-06, 'epoch': 9.37}
{'loss': 0.0146, 'learning_rate': 3.230472516875603e-06, 'epoch': 9.41}
{'loss': 0.0165, 'learning_rate': 2.9893924783027966e-06, 'epoch': 9.45}
{'loss': 0.0178, 'learning_rate': 2.7483124397299903e-06, 'epoch': 9.5}
{'loss': 0.0157, 'learning_rate': 2.5072324011571843e-06, 'epoch': 9.54}
{'loss': 0.0141, 'learning_rate': 2.266152362584378e-06, 'epoch': 9.59}
{'loss': 0.0152, 'learning_rate': 2.0250723240115716e-06, 'epoch': 9.63}
{'loss': 0.0137, 'learning_rate': 1.7839922854387657e-06, 'epoch': 9.67}
{'loss': 0.0132, 'learning_rate': 1.5429122468659597e-06, 'epoch': 9.72}
{'loss': 0.0157, 'learning_rate': 1.3018322082931534e-06, 'epoch': 9.76}
{'loss': 0.0139, 'learning_rate': 1.0607521697203472e-06, 'epoch': 9.81}
{'loss': 0.0165, 'learning_rate': 8.19672131147541e-07, 'epoch': 9.85}
{'loss': 0.0136, 'learning_rate': 5.785920925747349e-07, 'epoch': 9.89}
{'loss': 0.0159, 'learning_rate': 3.3751205400192864e-07, 'epoch': 9.94}
{'loss': 0.0135, 'learning_rate': 9.643201542912248e-08, 'epoch': 9.98}
{'eval_loss': 0.7229041457176208, 'eval_accuracy': 0.9010388325500865, 'eval_runtime': 1226.156, 'eval_samples_per_second': 32.973, 'eval_steps_per_second': 2.061, 'epoch': 10.0}
{'train_runtime': 285472.4357, 'train_samples_per_second': 12.745, 'train_steps_per_second': 0.398, 'train_loss': 0.12434842917619301, 'epoch': 10.0}
Total training time: 285472.57 seconds
######################################################################
layer-wise fine-tuning top 5
Using cuda
Downloading builder script: 0.00B [00:00, ?B/s]Downloading builder script: 4.20kB [00:00, 10.2MB/s]
Downloading builder script: 0.00B [00:00, ?B/s]Downloading builder script: 28.8kB [00:00, 50.1MB/s]
Downloading metadata: 0.00B [00:00, ?B/s]Downloading metadata: 28.7kB [00:00, 58.9MB/s]
Downloading readme: 0.00B [00:00, ?B/s]Downloading readme: 27.9kB [00:00, 25.9MB/s]
  0%|          | 0/3 [00:00<?, ?it/s] 67%|██████▋   | 2/3 [00:00<00:00, 13.73it/s]100%|██████████| 3/3 [00:00<00:00, 18.24it/s]
/work/dmpetrov_umass_edu/anaconda3/envs/finetuning/lib/python3.9/site-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
slurmstepd-gypsum-gpu025: error: *** JOB 7776379 ON gypsum-gpu025 CANCELLED AT 2023-06-21T22:46:40 DUE TO TIME LIMIT ***
