######################################################################
full model fine-tuning
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.0.2) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
Using cuda
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 371.21it/s]
/home/schalkapurka_umass_edu/.local/lib/python3.8/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
{'eval_loss': 4.360917568206787, 'eval_accuracy': 0.22933333333333333, 'eval_runtime': 50.4654, 'eval_samples_per_second': 29.723, 'eval_steps_per_second': 1.863, 'epoch': 1.0}
{'eval_loss': 2.7542378902435303, 'eval_accuracy': 0.23733333333333334, 'eval_runtime': 50.1756, 'eval_samples_per_second': 29.895, 'eval_steps_per_second': 1.873, 'epoch': 2.0}
{'loss': 4.1996, 'learning_rate': 2.5e-06, 'epoch': 2.78}
{'eval_loss': 0.6575174331665039, 'eval_accuracy': 0.5066666666666667, 'eval_runtime': 50.2599, 'eval_samples_per_second': 29.845, 'eval_steps_per_second': 1.87, 'epoch': 3.0}
{'eval_loss': 0.5907334685325623, 'eval_accuracy': 0.5226666666666666, 'eval_runtime': 50.1996, 'eval_samples_per_second': 29.881, 'eval_steps_per_second': 1.873, 'epoch': 4.0}
{'eval_loss': 0.5283046960830688, 'eval_accuracy': 0.546, 'eval_runtime': 50.2045, 'eval_samples_per_second': 29.878, 'eval_steps_per_second': 1.872, 'epoch': 5.0}
{'loss': 0.6494, 'learning_rate': 5e-06, 'epoch': 5.56}
{'eval_loss': 0.5292066335678101, 'eval_accuracy': 0.552, 'eval_runtime': 50.2288, 'eval_samples_per_second': 29.863, 'eval_steps_per_second': 1.871, 'epoch': 6.0}
{'eval_loss': 0.5154799222946167, 'eval_accuracy': 0.5546666666666666, 'eval_runtime': 50.2668, 'eval_samples_per_second': 29.841, 'eval_steps_per_second': 1.87, 'epoch': 7.0}
{'eval_loss': 0.526187539100647, 'eval_accuracy': 0.5526666666666666, 'eval_runtime': 50.3698, 'eval_samples_per_second': 29.78, 'eval_steps_per_second': 1.866, 'epoch': 8.0}
{'loss': 0.3559, 'learning_rate': 7.5e-06, 'epoch': 8.33}
{'eval_loss': 0.5134097337722778, 'eval_accuracy': 0.5686666666666667, 'eval_runtime': 50.2126, 'eval_samples_per_second': 29.873, 'eval_steps_per_second': 1.872, 'epoch': 9.0}
{'eval_loss': 0.4871535301208496, 'eval_accuracy': 0.574, 'eval_runtime': 50.3206, 'eval_samples_per_second': 29.809, 'eval_steps_per_second': 1.868, 'epoch': 10.0}
{'train_runtime': 5879.9479, 'train_samples_per_second': 9.777, 'train_steps_per_second': 0.306, 'train_loss': 1.4843155076768664, 'epoch': 10.0}
Total training time: 5879.96 seconds
######################################################################
layer-wise fine-tuning top 1
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.0.2) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
Using cuda
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 155.22it/s]
/home/schalkapurka_umass_edu/.local/lib/python3.8/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
layers to freeze ('bert.encoder.layer.0', 'bert.encoder.layer.2', 'bert.encoder.layer.3', 'bert.encoder.layer.4', 'bert.encoder.layer.5', 'bert.encoder.layer.6', 'bert.encoder.layer.7', 'bert.encoder.layer.8', 'bert.encoder.layer.9', 'bert.encoder.layer.10', 'bert.encoder.layer.11')
{'eval_loss': 4.747679233551025, 'eval_accuracy': 0.22933333333333333, 'eval_runtime': 50.4223, 'eval_samples_per_second': 29.749, 'eval_steps_per_second': 1.864, 'epoch': 1.0}
{'eval_loss': 3.8740696907043457, 'eval_accuracy': 0.26, 'eval_runtime': 50.5426, 'eval_samples_per_second': 29.678, 'eval_steps_per_second': 1.86, 'epoch': 2.0}
{'loss': 5.3061, 'learning_rate': 2.5e-06, 'epoch': 2.78}
{'eval_loss': 2.8313915729522705, 'eval_accuracy': 0.238, 'eval_runtime': 50.5204, 'eval_samples_per_second': 29.691, 'eval_steps_per_second': 1.861, 'epoch': 3.0}
{'eval_loss': 1.8221187591552734, 'eval_accuracy': 0.2793333333333333, 'eval_runtime': 50.5376, 'eval_samples_per_second': 29.681, 'eval_steps_per_second': 1.86, 'epoch': 4.0}
{'eval_loss': 1.1345516443252563, 'eval_accuracy': 0.31933333333333336, 'eval_runtime': 50.4248, 'eval_samples_per_second': 29.747, 'eval_steps_per_second': 1.864, 'epoch': 5.0}
{'loss': 2.2106, 'learning_rate': 5e-06, 'epoch': 5.56}
{'eval_loss': 0.984316885471344, 'eval_accuracy': 0.44066666666666665, 'eval_runtime': 50.5273, 'eval_samples_per_second': 29.687, 'eval_steps_per_second': 1.86, 'epoch': 6.0}
{'eval_loss': 0.9313459992408752, 'eval_accuracy': 0.4493333333333333, 'eval_runtime': 50.4888, 'eval_samples_per_second': 29.71, 'eval_steps_per_second': 1.862, 'epoch': 7.0}
{'eval_loss': 0.8747625350952148, 'eval_accuracy': 0.4573333333333333, 'eval_runtime': 50.3867, 'eval_samples_per_second': 29.77, 'eval_steps_per_second': 1.866, 'epoch': 8.0}
{'loss': 0.9788, 'learning_rate': 7.5e-06, 'epoch': 8.33}
{'eval_loss': 0.834627628326416, 'eval_accuracy': 0.4573333333333333, 'eval_runtime': 50.4709, 'eval_samples_per_second': 29.72, 'eval_steps_per_second': 1.862, 'epoch': 9.0}
{'eval_loss': 0.8166218400001526, 'eval_accuracy': 0.4613333333333333, 'eval_runtime': 50.4842, 'eval_samples_per_second': 29.712, 'eval_steps_per_second': 1.862, 'epoch': 10.0}
{'train_runtime': 4773.4971, 'train_samples_per_second': 12.044, 'train_steps_per_second': 0.377, 'train_loss': 2.492526813083225, 'epoch': 10.0}
Total training time: 4773.55 seconds
######################################################################
layer-wise fine-tuning top 2
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.0.2) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
Using cuda
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 297.18it/s]
/home/schalkapurka_umass_edu/.local/lib/python3.8/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
layers to freeze ('bert.encoder.layer.0', 'bert.encoder.layer.2', 'bert.encoder.layer.3', 'bert.encoder.layer.5', 'bert.encoder.layer.6', 'bert.encoder.layer.7', 'bert.encoder.layer.8', 'bert.encoder.layer.9', 'bert.encoder.layer.10', 'bert.encoder.layer.11')
{'eval_loss': 4.708148956298828, 'eval_accuracy': 0.22933333333333333, 'eval_runtime': 50.4078, 'eval_samples_per_second': 29.757, 'eval_steps_per_second': 1.865, 'epoch': 1.0}
{'eval_loss': 3.8476271629333496, 'eval_accuracy': 0.25666666666666665, 'eval_runtime': 50.6092, 'eval_samples_per_second': 29.639, 'eval_steps_per_second': 1.857, 'epoch': 2.0}
{'loss': 5.2807, 'learning_rate': 2.5e-06, 'epoch': 2.78}
{'eval_loss': 2.8417859077453613, 'eval_accuracy': 0.24333333333333335, 'eval_runtime': 50.353, 'eval_samples_per_second': 29.79, 'eval_steps_per_second': 1.867, 'epoch': 3.0}
{'eval_loss': 1.732114553451538, 'eval_accuracy': 0.3373333333333333, 'eval_runtime': 50.358, 'eval_samples_per_second': 29.787, 'eval_steps_per_second': 1.867, 'epoch': 4.0}
{'eval_loss': 0.9669679403305054, 'eval_accuracy': 0.4166666666666667, 'eval_runtime': 50.5564, 'eval_samples_per_second': 29.67, 'eval_steps_per_second': 1.859, 'epoch': 5.0}
{'loss': 2.0998, 'learning_rate': 5e-06, 'epoch': 5.56}
{'eval_loss': 0.7813276648521423, 'eval_accuracy': 0.476, 'eval_runtime': 50.3579, 'eval_samples_per_second': 29.787, 'eval_steps_per_second': 1.867, 'epoch': 6.0}
{'eval_loss': 0.7301569581031799, 'eval_accuracy': 0.49133333333333334, 'eval_runtime': 50.5288, 'eval_samples_per_second': 29.686, 'eval_steps_per_second': 1.86, 'epoch': 7.0}
{'eval_loss': 0.6402313113212585, 'eval_accuracy': 0.4866666666666667, 'eval_runtime': 50.4091, 'eval_samples_per_second': 29.757, 'eval_steps_per_second': 1.865, 'epoch': 8.0}
{'loss': 0.7504, 'learning_rate': 7.5e-06, 'epoch': 8.33}
{'eval_loss': 0.6280546188354492, 'eval_accuracy': 0.512, 'eval_runtime': 50.4703, 'eval_samples_per_second': 29.72, 'eval_steps_per_second': 1.862, 'epoch': 9.0}
{'eval_loss': 0.6107041239738464, 'eval_accuracy': 0.5126666666666667, 'eval_runtime': 50.5345, 'eval_samples_per_second': 29.683, 'eval_steps_per_second': 1.86, 'epoch': 10.0}
{'train_runtime': 4876.748, 'train_samples_per_second': 11.789, 'train_steps_per_second': 0.369, 'train_loss': 2.3515140787760416, 'epoch': 10.0}
Total training time: 4876.80 seconds
######################################################################
layer-wise fine-tuning top 3
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.0.2) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
Using cuda
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 476.70it/s]
/home/schalkapurka_umass_edu/.local/lib/python3.8/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
layers to freeze ('bert.encoder.layer.0', 'bert.encoder.layer.2', 'bert.encoder.layer.5', 'bert.encoder.layer.6', 'bert.encoder.layer.7', 'bert.encoder.layer.8', 'bert.encoder.layer.9', 'bert.encoder.layer.10', 'bert.encoder.layer.11')
{'eval_loss': 4.684709548950195, 'eval_accuracy': 0.22933333333333333, 'eval_runtime': 50.5064, 'eval_samples_per_second': 29.699, 'eval_steps_per_second': 1.861, 'epoch': 1.0}
{'eval_loss': 3.8309519290924072, 'eval_accuracy': 0.25533333333333336, 'eval_runtime': 50.525, 'eval_samples_per_second': 29.688, 'eval_steps_per_second': 1.86, 'epoch': 2.0}
{'loss': 5.2641, 'learning_rate': 2.5e-06, 'epoch': 2.78}
{'eval_loss': 2.837716817855835, 'eval_accuracy': 0.24866666666666667, 'eval_runtime': 50.3921, 'eval_samples_per_second': 29.767, 'eval_steps_per_second': 1.865, 'epoch': 3.0}
{'eval_loss': 1.717315435409546, 'eval_accuracy': 0.35, 'eval_runtime': 50.4167, 'eval_samples_per_second': 29.752, 'eval_steps_per_second': 1.864, 'epoch': 4.0}
{'eval_loss': 0.8563613891601562, 'eval_accuracy': 0.4713333333333333, 'eval_runtime': 50.451, 'eval_samples_per_second': 29.732, 'eval_steps_per_second': 1.863, 'epoch': 5.0}
{'loss': 2.0598, 'learning_rate': 5e-06, 'epoch': 5.56}
{'eval_loss': 0.6449072957038879, 'eval_accuracy': 0.492, 'eval_runtime': 50.4743, 'eval_samples_per_second': 29.718, 'eval_steps_per_second': 1.862, 'epoch': 6.0}
{'eval_loss': 0.5957605838775635, 'eval_accuracy': 0.48733333333333334, 'eval_runtime': 50.6237, 'eval_samples_per_second': 29.63, 'eval_steps_per_second': 1.857, 'epoch': 7.0}
{'eval_loss': 0.562889814376831, 'eval_accuracy': 0.5086666666666667, 'eval_runtime': 50.4592, 'eval_samples_per_second': 29.727, 'eval_steps_per_second': 1.863, 'epoch': 8.0}
{'loss': 0.6208, 'learning_rate': 7.5e-06, 'epoch': 8.33}
{'eval_loss': 0.5710439682006836, 'eval_accuracy': 0.514, 'eval_runtime': 50.4548, 'eval_samples_per_second': 29.73, 'eval_steps_per_second': 1.863, 'epoch': 9.0}
{'eval_loss': 0.5635327696800232, 'eval_accuracy': 0.516, 'eval_runtime': 50.3861, 'eval_samples_per_second': 29.77, 'eval_steps_per_second': 1.866, 'epoch': 10.0}
{'train_runtime': 4971.2304, 'train_samples_per_second': 11.565, 'train_steps_per_second': 0.362, 'train_loss': 2.2797587924533422, 'epoch': 10.0}
Total training time: 4971.28 seconds
######################################################################
layer-wise fine-tuning top 4
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.0.2) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
Using cuda
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 358.61it/s]
/home/schalkapurka_umass_edu/.local/lib/python3.8/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
layers to freeze ('bert.encoder.layer.2', 'bert.encoder.layer.5', 'bert.encoder.layer.6', 'bert.encoder.layer.7', 'bert.encoder.layer.8', 'bert.encoder.layer.9', 'bert.encoder.layer.10', 'bert.encoder.layer.11')
{'eval_loss': 4.676155090332031, 'eval_accuracy': 0.22933333333333333, 'eval_runtime': 50.1476, 'eval_samples_per_second': 29.912, 'eval_steps_per_second': 1.874, 'epoch': 1.0}
{'eval_loss': 3.8237860202789307, 'eval_accuracy': 0.254, 'eval_runtime': 50.2035, 'eval_samples_per_second': 29.878, 'eval_steps_per_second': 1.872, 'epoch': 2.0}
{'loss': 5.2572, 'learning_rate': 2.5e-06, 'epoch': 2.78}
{'eval_loss': 2.830373764038086, 'eval_accuracy': 0.26, 'eval_runtime': 50.2557, 'eval_samples_per_second': 29.847, 'eval_steps_per_second': 1.87, 'epoch': 3.0}
{'eval_loss': 1.7130569219589233, 'eval_accuracy': 0.35533333333333333, 'eval_runtime': 50.2742, 'eval_samples_per_second': 29.836, 'eval_steps_per_second': 1.87, 'epoch': 4.0}
{'eval_loss': 0.7496954202651978, 'eval_accuracy': 0.498, 'eval_runtime': 50.2937, 'eval_samples_per_second': 29.825, 'eval_steps_per_second': 1.869, 'epoch': 5.0}
{'loss': 2.021, 'learning_rate': 5e-06, 'epoch': 5.56}
{'eval_loss': 0.5998122692108154, 'eval_accuracy': 0.5093333333333333, 'eval_runtime': 50.1172, 'eval_samples_per_second': 29.93, 'eval_steps_per_second': 1.876, 'epoch': 6.0}
{'eval_loss': 0.5720499157905579, 'eval_accuracy': 0.5273333333333333, 'eval_runtime': 50.3743, 'eval_samples_per_second': 29.777, 'eval_steps_per_second': 1.866, 'epoch': 7.0}
{'eval_loss': 0.5507113337516785, 'eval_accuracy': 0.532, 'eval_runtime': 50.2418, 'eval_samples_per_second': 29.856, 'eval_steps_per_second': 1.871, 'epoch': 8.0}
{'loss': 0.5699, 'learning_rate': 7.5e-06, 'epoch': 8.33}
{'eval_loss': 0.5626198649406433, 'eval_accuracy': 0.538, 'eval_runtime': 50.2616, 'eval_samples_per_second': 29.844, 'eval_steps_per_second': 1.87, 'epoch': 9.0}
{'eval_loss': 0.5560129284858704, 'eval_accuracy': 0.528, 'eval_runtime': 50.1535, 'eval_samples_per_second': 29.908, 'eval_steps_per_second': 1.874, 'epoch': 10.0}
{'train_runtime': 5081.8237, 'train_samples_per_second': 11.313, 'train_steps_per_second': 0.354, 'train_loss': 2.2460001966688368, 'epoch': 10.0}
Total training time: 5081.84 seconds
######################################################################
layer-wise fine-tuning top 5
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.0.2) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
Using cuda
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 384.49it/s]
/home/schalkapurka_umass_edu/.local/lib/python3.8/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
layers to freeze ('bert.encoder.layer.5', 'bert.encoder.layer.6', 'bert.encoder.layer.7', 'bert.encoder.layer.8', 'bert.encoder.layer.9', 'bert.encoder.layer.10', 'bert.encoder.layer.11')
{'eval_loss': 4.662266731262207, 'eval_accuracy': 0.22933333333333333, 'eval_runtime': 50.2186, 'eval_samples_per_second': 29.869, 'eval_steps_per_second': 1.872, 'epoch': 1.0}
{'eval_loss': 3.812178611755371, 'eval_accuracy': 0.25333333333333335, 'eval_runtime': 50.2384, 'eval_samples_per_second': 29.858, 'eval_steps_per_second': 1.871, 'epoch': 2.0}
{'loss': 5.247, 'learning_rate': 2.5e-06, 'epoch': 2.78}
{'eval_loss': 2.8244693279266357, 'eval_accuracy': 0.266, 'eval_runtime': 50.2793, 'eval_samples_per_second': 29.833, 'eval_steps_per_second': 1.87, 'epoch': 3.0}
{'eval_loss': 1.6339471340179443, 'eval_accuracy': 0.3566666666666667, 'eval_runtime': 50.218, 'eval_samples_per_second': 29.87, 'eval_steps_per_second': 1.872, 'epoch': 4.0}
{'eval_loss': 0.6649520397186279, 'eval_accuracy': 0.49, 'eval_runtime': 50.3225, 'eval_samples_per_second': 29.808, 'eval_steps_per_second': 1.868, 'epoch': 5.0}
{'loss': 1.9175, 'learning_rate': 5e-06, 'epoch': 5.56}
{'eval_loss': 0.588075578212738, 'eval_accuracy': 0.5186666666666667, 'eval_runtime': 50.1559, 'eval_samples_per_second': 29.907, 'eval_steps_per_second': 1.874, 'epoch': 6.0}
{'eval_loss': 0.5865756869316101, 'eval_accuracy': 0.514, 'eval_runtime': 50.1887, 'eval_samples_per_second': 29.887, 'eval_steps_per_second': 1.873, 'epoch': 7.0}
{'eval_loss': 0.5744848847389221, 'eval_accuracy': 0.5346666666666666, 'eval_runtime': 50.4037, 'eval_samples_per_second': 29.76, 'eval_steps_per_second': 1.865, 'epoch': 8.0}
{'loss': 0.5354, 'learning_rate': 7.5e-06, 'epoch': 8.33}
{'eval_loss': 0.5867946147918701, 'eval_accuracy': 0.546, 'eval_runtime': 50.1303, 'eval_samples_per_second': 29.922, 'eval_steps_per_second': 1.875, 'epoch': 9.0}
{'eval_loss': 0.5632436275482178, 'eval_accuracy': 0.5406666666666666, 'eval_runtime': 50.2582, 'eval_samples_per_second': 29.846, 'eval_steps_per_second': 1.87, 'epoch': 10.0}
{'train_runtime': 5169.3681, 'train_samples_per_second': 11.121, 'train_steps_per_second': 0.348, 'train_loss': 2.1997933875189886, 'epoch': 10.0}
Total training time: 5169.40 seconds
######################################################################
finished
