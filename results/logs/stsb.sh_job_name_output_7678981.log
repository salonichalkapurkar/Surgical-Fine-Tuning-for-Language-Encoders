######################################################################
layer-wise fine-tuning top 1
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.0.2) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
Using cuda
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 35.32it/s]
/home/schalkapurka_umass_edu/.local/lib/python3.8/site-packages/transformers/optimization.py:391: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
layers to freeze ('bert.encoder.layer.0', 'bert.encoder.layer.1', 'bert.encoder.layer.2', 'bert.encoder.layer.3', 'bert.encoder.layer.4', 'bert.encoder.layer.6', 'bert.encoder.layer.7', 'bert.encoder.layer.8', 'bert.encoder.layer.9', 'bert.encoder.layer.10', 'bert.encoder.layer.11')
{'eval_loss': 4.710998058319092, 'eval_accuracy': 0.22933333333333333, 'eval_runtime': 50.419, 'eval_samples_per_second': 29.751, 'eval_steps_per_second': 1.864, 'epoch': 1.0}
{'eval_loss': 3.8457841873168945, 'eval_accuracy': 0.26266666666666666, 'eval_runtime': 50.3581, 'eval_samples_per_second': 29.787, 'eval_steps_per_second': 1.867, 'epoch': 2.0}
{'loss': 5.2817, 'learning_rate': 2.5e-06, 'epoch': 2.78}
{'eval_loss': 2.843613862991333, 'eval_accuracy': 0.24266666666666667, 'eval_runtime': 50.3842, 'eval_samples_per_second': 29.771, 'eval_steps_per_second': 1.866, 'epoch': 3.0}
{'eval_loss': 1.730325698852539, 'eval_accuracy': 0.3313333333333333, 'eval_runtime': 50.3085, 'eval_samples_per_second': 29.816, 'eval_steps_per_second': 1.868, 'epoch': 4.0}
{'eval_loss': 0.9536983966827393, 'eval_accuracy': 0.43733333333333335, 'eval_runtime': 50.3729, 'eval_samples_per_second': 29.778, 'eval_steps_per_second': 1.866, 'epoch': 5.0}
{'loss': 2.1079, 'learning_rate': 5e-06, 'epoch': 5.56}
{'eval_loss': 0.8196205496788025, 'eval_accuracy': 0.46, 'eval_runtime': 50.4511, 'eval_samples_per_second': 29.732, 'eval_steps_per_second': 1.863, 'epoch': 6.0}
{'eval_loss': 0.7517247200012207, 'eval_accuracy': 0.478, 'eval_runtime': 50.1378, 'eval_samples_per_second': 29.918, 'eval_steps_per_second': 1.875, 'epoch': 7.0}
{'eval_loss': 0.6540403366088867, 'eval_accuracy': 0.4866666666666667, 'eval_runtime': 50.3541, 'eval_samples_per_second': 29.789, 'eval_steps_per_second': 1.867, 'epoch': 8.0}
{'loss': 0.8131, 'learning_rate': 7.5e-06, 'epoch': 8.33}
{'eval_loss': 0.6334201097488403, 'eval_accuracy': 0.5073333333333333, 'eval_runtime': 50.3549, 'eval_samples_per_second': 29.789, 'eval_steps_per_second': 1.867, 'epoch': 9.0}
{'eval_loss': 0.6183545589447021, 'eval_accuracy': 0.508, 'eval_runtime': 50.3318, 'eval_samples_per_second': 29.802, 'eval_steps_per_second': 1.868, 'epoch': 10.0}
{'train_runtime': 4769.1013, 'train_samples_per_second': 12.055, 'train_steps_per_second': 0.377, 'train_loss': 2.3826715596516927, 'epoch': 10.0}
Total training time: 4769.13 seconds
######################################################################
finished
